{"version":3,"sources":["./src/app/services/user/SubmitScore.service.ts","./src/app/ui-phone/submit/submit-home/home.component.html","./src/app/ui-phone/submit/submit-home/home.component.scss","./src/app/ui-phone/submit/submit-home/home.component.ts","./src/app/ui-phone/submit/submit.module.ts"],"names":[],"mappings":"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","file":"submit.module.chunk.js","sourcesContent":["import {Injectable} from '@angular/core';\r\nimport {HttpClient} from '@angular/common/http';\r\nimport {Router } from '@angular/router';\r\nimport {SITE_HOST_URL, AddUserScore} from '../../config/api';\r\nimport {Record} from '../../date/table-data';\r\n@Injectable()\r\nexport class SubmitScoreService {\r\n  rec: any;\r\n  constructor(\r\n    private http: HttpClient,\r\n    private router: Router\r\n  ) {}\r\n  AddScore(record: Record) {\r\n    const body = JSON.stringify(record);\r\n    return this.http.post(SITE_HOST_URL + AddUserScore, body)\r\n  }\r\n\r\n  UploadMP4(formate:any){\r\n   return this.http.post('http://localhost:80/api/uploadMP4',formate);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/services/user/SubmitScore.service.ts","module.exports = \"\\r\\n \\r\\n<div (click)=\\\"GotoActivity()\\\" style=\\\"background: #f5f5f5;\\r\\n    height: 45px;\\\"><i class=\\\"fas fa-angle-left\\\" style=\\\"    font-size: 40px;\\r\\n    margin-right: 10px;\\r\\n    float: left;\\\"></i>\\r\\n  <div style=\\\"     font-size: 20px;\\r\\n    line-height: 40px;\\\">{{title}}\\r\\n  </div>\\r\\n</div>\\r\\n<div style=\\\"\\r\\n    width: 100%;\\r\\n    height: 93%;\\r\\n       -webkit-box-align: center;\\r\\n    align-items: center;\\r\\n       -webkit-box-pack: center;\\r\\n    justify-content: center;\\r\\n    text-align: center;\\r\\n    background-color: #f5f5f5;\\r\\n    display: flex;\\\">\\r\\n  <div class=\\\"form-signin\\\" style=\\\"    width: 100%;\\r\\n    max-width: 330px;\\r\\n    padding: 15px;\\r\\n    margin: 0 auto;\\\">\\r\\n\\r\\n    <h1 class=\\\"h3 mb-3 font-weight-normal\\\">Submit Score</h1>\\r\\n    <label for=\\\"inputEmail\\\" class=\\\"sr-only\\\">请输入您的比赛成绩</label>\\r\\n    <input type=\\\"text\\\" id=\\\"inputEmail\\\" class=\\\"form-control\\\" placeholder=\\\"请输入您的比赛成绩\\\" required autofocus\\r\\n           style=\\\"text-align: center;\\\" [(ngModel)]=\\\"Score\\\">\\r\\n\\r\\n    <!--获取参赛者位置-->\\r\\n    <div class=\\\"checkbox mb-3\\\">\\r\\n    </div>\\r\\n    <div class=\\\"mb-4\\\" style=\\\"width: 300px;height: 150px;\\\" *ngIf=\\\"isMap==true\\\">\\r\\n      <baidu-map [options]=\\\"opts\\\">\\r\\n        <marker *ngFor=\\\"let marker of markers\\\" [point]=\\\"marker.point\\\"></marker>\\r\\n      </baidu-map>\\r\\n    </div>\\r\\n    <button class=\\\"btn btn-lg btn-primary btn-block\\\" (click)=\\\"getLocation()\\\">获取位置</button>\\r\\n\\r\\n    <!--提交比赛成绩-->\\r\\n    <div class=\\\"checkbox mb-3\\\">\\r\\n    </div>\\r\\n    <video src={{this.record.MP4URL}} width=\\\"300\\\" height=\\\"150\\\" controls=\\\"controls\\\" *ngIf=\\\"isShow==true\\\">\\r\\n    </video>\\r\\n\\r\\n    <div class=\\\" btn-lg btn-primary btn-block\\\" style=\\\" position: relative;\\r\\n    display: inline-block; height: 48px\\\">\\r\\n      <input type=\\\"file\\\" accept=\\\"video/*\\\" name=\\\"video\\\" (change)=\\\"selectedFileOnChanged($event)\\\" style=\\\" opacity: 0;\\\">\\r\\n      <span style=\\\" position: absolute;\\r\\n   top: 9px;\\r\\n    left: 108px;\\\">上传视频</span>\\r\\n    </div>\\r\\n\\r\\n\\r\\n    <div class=\\\"checkbox mb-3\\\">\\r\\n    </div>\\r\\n    <button class=\\\"btn btn-lg btn-primary btn-block\\\" data-toggle=\\\"modal\\\" data-target=\\\"#exampleModalCenter\\\" type=\\\"submit\\\"\\r\\n            (click)=\\\"AddScore()\\\" (keyup.enter)=\\\"AddScore()\\\">提交成绩\\r\\n    </button>\\r\\n\\r\\n\\r\\n    <div class=\\\"modal fade\\\" id=\\\"exampleModalCenter\\\" tabindex=\\\"-1\\\" role=\\\"dialog\\\"\\r\\n         aria-labelledby=\\\"exampleModalCenterTitle\\\" aria-hidden=\\\"true\\\">\\r\\n      <div class=\\\"modal-dialog modal-dialog-centered\\\" role=\\\"document\\\">\\r\\n        <div class=\\\"modal-content\\\">\\r\\n          <div class=\\\"modal-header\\\">\\r\\n            <h5 class=\\\"modal-title\\\" id=\\\"exampleModalLongTitle\\\">提示</h5>\\r\\n            <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"modal\\\" aria-label=\\\"Close\\\">\\r\\n              <span aria-hidden=\\\"true\\\">&times;</span>\\r\\n            </button>\\r\\n          </div>\\r\\n          <div class=\\\"modal-body\\\" *ngIf=\\\"isfull==true\\\">\\r\\n            您提交的比赛成绩排名为{{Rank}}\\r\\n          </div>\\r\\n          <div class=\\\"modal-body\\\" *ngIf=\\\"isfull==false\\\">\\r\\n            您还未提写完全\\r\\n          </div>\\r\\n          <div class=\\\"modal-footer\\\">\\r\\n            <button type=\\\"button\\\" class=\\\"btn btn-secondary\\\" data-dismiss=\\\"modal\\\" *ngIf=\\\"isfull==false\\\">Close</button>\\r\\n            <button type=\\\"button\\\" class=\\\"btn btn-primary\\\" data-dismiss=\\\"modal\\\" (click)=\\\"GotoActivity()\\\"\\r\\n                    *ngIf=\\\"isfull==true\\\">Sure\\r\\n            </button>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n  </div>\\r\\n</div>\\r\\n\\r\\n\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/ui-phone/submit/submit-home/home.component.html\n// module id = ./src/app/ui-phone/submit/submit-home/home.component.html\n// module chunks = submit.module","module.exports = \"\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/ui-phone/submit/submit-home/home.component.scss\n// module id = ./src/app/ui-phone/submit/submit-home/home.component.scss\n// module chunks = submit.module","import {Component, OnInit} from '@angular/core';\r\nimport {SubmitScoreService} from '../../../services/user/SubmitScore.service';\r\nimport {Record} from '../../../date/table-data';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {MapOptions, Point} from 'angular2-baidu-map';\r\nimport {SITE_HOST_URL} from '../../../config/api';\r\n\r\n@Component({\r\n  selector: 'app-home',\r\n  templateUrl: './home.component.html',\r\n  styleUrls: ['./home.component.scss']\r\n})\r\nexport class HomeComponent implements OnInit {\r\n  record: Record = new Record();\r\n  Score: string;\r\n  title: string;\r\n  isMap: boolean;\r\n  opts: MapOptions;\r\n  markers: Array<{ point: Point }>;\r\n  isShow: boolean;\r\n  isfull: boolean;\r\n  Rank: any;\r\n\r\n  constructor(private activatedRoute: ActivatedRoute,\r\n              private submitscore: SubmitScoreService,\r\n              private router: Router,) {\r\n  }\r\n\r\n\r\n  ngOnInit() {\r\n    this.isMap = this.isShow = this.isfull = false;\r\n    this.activatedRoute.queryParams.subscribe(queryParams => {\r\n      this.record.Actid = +queryParams.actid;\r\n      this.title = queryParams.title;\r\n    });\r\n\r\n  }\r\n\r\n//添加用户成绩\r\n  AddScore() {\r\n    this.record.Stuid = Number(localStorage.getItem('stuid'));\r\n    console.log(this.record.Stuid);\r\n    this.record.Score = Number(this.Score);\r\n    this.record.CancelScore = this.record.CancelMatch = false;\r\n    if (this.record.MP4URL == '' || this.record.MP4URL == null || this.record.Longitude == null || this.record.Longitude == 0 || this.Score == '' || this.Score == null) {\r\n      return;\r\n    }\r\n    this.isfull = true;\r\n    this.submitscore.AddScore(this.record).subscribe(\r\n      val => {\r\n        console.log(val);\r\n        this.Rank = val;\r\n      },\r\n      err => {\r\n        console.log(err);\r\n      }\r\n    );\r\n  }\r\n\r\n\r\n  GotoActivity() {\r\n    this.router.navigate(['phoneactivity/detail'], {queryParams: {'Actid': this.record.Actid}});\r\n  }\r\n\r\n\r\n  //调取用户的地理定位\r\n  getLocation() {\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition(\r\n        position => {\r\n          this.opts = {\r\n            centerAndZoom: {\r\n              lat: position.coords.latitude,\r\n              lng: position.coords.longitude,\r\n              zoom: 11,\r\n            },\r\n          };\r\n          this.markers = [\r\n            {\r\n              point: {\r\n                lat: position.coords.latitude,\r\n                lng: position.coords.longitude,\r\n              }\r\n            }\r\n          ];\r\n          this.record.Latitude = position.coords.latitude;\r\n          this.record.Longitude = position.coords.longitude;\r\n          this.isMap = true;\r\n        },\r\n        error => {\r\n          console.log(error);\r\n        }\r\n      );\r\n\r\n    } else {\r\n      console.log('Geolocation is not supported by this browser.');\r\n    }\r\n  }\r\n\r\n\r\n  //用户上传的小视频\r\n  selectedFileOnChanged(event: any) {\r\n    let files = event.target.files[0];\r\n    let formate = new FormData();\r\n    formate.append('video', files, files.name);\r\n    this.submitscore.UploadMP4(formate).subscribe(\r\n      res => {\r\n        this.isShow = true;\r\n        this.record.MP4URL = SITE_HOST_URL + '/video/' + res;\r\n      },\r\n      err => {\r\n        console.log(err);\r\n      }\r\n    );\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/ui-phone/submit/submit-home/home.component.ts","import { CommonModule} from '@angular/common';\r\nimport { NgModule} from '@angular/core';\r\nimport {RouterModule, Routes} from '@angular/router';\r\nimport { FormsModule } from '@angular/forms';\r\nimport {HomeComponent} from './submit-home/home.component';\r\nimport {SubmitScoreService} from '../../services/user/SubmitScore.service';\r\nimport {HttpClientModule} from '@angular/common/http';\r\nimport {BaiduMapModule} from 'angular2-baidu-map';\r\n\r\nconst SubmitRoutes: Routes = [\r\n  {\r\n    path: '',\r\n    redirectTo: 'submit',\r\n    pathMatch: 'full'\r\n  },\r\n  {\r\n    path: 'submit',\r\n    component: HomeComponent\r\n  },\r\n  {\r\n    path:'**',\r\n    redirectTo:'submit'\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  declarations: [\r\n    HomeComponent,\r\n  ],\r\n  imports:  [\r\n    CommonModule,\r\n    FormsModule,\r\n    RouterModule.forChild(SubmitRoutes),\r\n    HttpClientModule,\r\n    BaiduMapModule.forRoot({ak: '4bPC8CWnuywBlz3QjjbUZ9uDwmLItn9k\t'})\r\n  ],\r\n  exports: [],\r\n  providers: [SubmitScoreService]\r\n})\r\nexport class SubmitModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/ui-phone/submit/submit.module.ts"],"sourceRoot":"webpack:///"}